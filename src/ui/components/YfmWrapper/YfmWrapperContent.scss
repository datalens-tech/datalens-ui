@import '~@gravity-ui/uikit/styles/mixins';

// support yfm dark theme

.g-root .yfm {
    --yfm-font-family-sans: var(--g-font-family-sans);
    --yfm-font-family-monospace: var(--g-font-family-monospace);

    font-family: var(--g-font-family-sans);
    @include text-body-1();

    // override common styles to make it look better with header widgets
    h1,
    h2,
    h3,
    h4,
    h5,
    h6 {
        font-weight: 500;
    }

    .g-root &:not(.yfm_only-light) img,
    img {
        background: transparent;
    }

    p.yfm-latex {
        text-align: left;
        display: inline-block;

        & > span {
            margin: 0;
        }
    }

    .yfm-cut-content table:last-child {
        margin-bottom: 0;
    }

    .yfm-cut:last-child .yfm-cut-content {
        padding-bottom: 0;
    }
}

.g-root .yfm:not(.yfm_only-light) {
    color: var(--g-color-text-primary);

    --yfm-color-hljs-background: var(--g-color-base-background);
    --yfm-color-hljs-subst: var(--g-color-text-complementary);
    --yfm-color-hljs-comment: var(--g-color-text-secondary);
    --yfm-color-hljs-deletion: var(--g-color-text-danger);
    --yfm-color-hljs-section: var(--g-color-text-danger);

    a {
        color: var(--g-color-text-link);

        &:hover,
        &:active {
            color: var(--g-color-text-link-hover);
        }
    }

    &.yfm_links-visited {
        a {
            &:visited {
                color: var(--g-color-text-link-visited);
            }

            &:visited:hover {
                color: var(--g-color-text-link-visited-hover);
            }
        }
    }

    img {
        background-color: var(--g-color-base-background);
    }

    $backgroundColors: (
        yfm-accent-info: var(--g-color-base-info-light),
        yfm-accent-tip: var(--g-color-base-positive-light),
        yfm-accent-alert: var(--g-color-base-danger-light),
        yfm-accent-warning: var(--g-color-base-warning-light),
    );

    @each $type, $color in $backgroundColors {
        &.#{$type} {
            background: $color;
        }
    }

    code {
        background: var(--g-color-base-misc-light);
        color: var(--g-color-text-misc-heavy);
    }

    pre > code {
        background: var(--g-color-base-misc-light);
        color: var(--g-color-text-complementary);
    }

    table {
        color: var(--g-color-text-primary);
        border-color: var(--g-color-line-generic);
        background: var(--g-color-base-background);
    }

    table thead,
    table tr:nth-child(2n) {
        background: var(--g-color-base-generic);
    }

    hr {
        background-color: var(--g-color-line-generic);
    }

    blockquote {
        border-left-color: var(--g-color-line-brand);
    }

    .yfm-tab-list {
        border-bottom-color: var(--g-color-line-generic);
    }

    .yfm-tab:hover,
    .yfm-tab:active {
        color: var(--g-color-text-link-hover);
    }

    .yfm-tab.active {
        border-bottom-color: var(--g-color-line-brand);
    }
}

.g-root_theme_dark .yfm,
.g-root_theme_dark-hc .yfm {
    .yfm-cut-title:before {
        background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxNiI+PHBhdGggc3Ryb2tlPSJyZ2JhKDI1NSwgMjU1LCAyNTUsIDAuNykiIGZpbGw9Im5vbmUiIGQ9Ik0zIDZsNSA1IDUtNSI+PC9wYXRoPjwvc3ZnPg==');
    }
}
